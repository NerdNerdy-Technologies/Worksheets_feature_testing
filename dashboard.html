<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
 <!--Cognito JavaScript-->
<script src="js/amazon-cognito-identity.min.js"></script>
<script src="js/config.js"></script>

<script src="https://js.stripe.com/v3/"></script>


  <title>Worksheets Dashboard</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="css/business-frontpage.css" rel="stylesheet">

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <a class="navbar-brand" href="#">JumpHats</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <!-- <a class="nav-link" href="#">Home
              <span class="sr-only">(current)</span>
            </a> -->
          </li>
          <li class="nav-item">
            <!-- <a class="nav-link" href="#">About</a> -->
          </li>
          <li>
            <div id="buy-btn" class="text-lg-center"><button class="btn btn-primary btn-marketing rounded-pill"  onclick="pay()">Buy Now !</button>
              <!-- <a class="btn btn-white btn-marketing rounded-pill my-2 lift lift-sm" href="#!">Create Account</a> -->
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#"><label id="email_value"></label></a>
              <!-- <label id="email_value"></label> -->
          </li>
          <li class="nav-item">
            <button type="button" class="btn btn-dark" onclick="signOut()">Sign out</button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="py-4 mb-4" style="background:#2c4d7e;">
    <div class="container h-100">
      <div class="row h-100 align-items-center">
        <div class="col-lg-12">
          <h1 class="display-4 text-white mt-5 mb-2">WorkSheets Dashboard</h1>
          <p class="lead mb-5 text-white-50">Find , create and currate worksheets for you child here help gain insights on his/her learning abilities and strengths.</p>
        </div>
      </div>
    </div>
  </header>


  <!-- Page Content -->
  <div class="container">

    <div class="row">
      <div class="col-md-8 mb-5">
        <!-- <h2>Start Now</h2> -->
        <!-- <hr> -->
        <!-- <p>Select from the below options, start with blank template to create a new worksheet, edit available templates or just download an expert currated worksheet in a minute !!</p> -->
        <!-- <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Omnis optio neque consectetur consequatur magni in nisi, natus beatae quidem quam odit commodi ducimus totam eum, alias, adipisci nesciunt voluptate. Voluptatum.</p> -->
        <!-- <a class="btn btn-primary btn-lg" href="#">Call to Action &raquo;</a> -->
      </div>
    </div>
    <!-- /.row -->

    <div class="row">
      <div class="col-md-4 mb-5">
        <div class="card h-100">
          <img class="card-img-top" src="./assets/worksheets_images/dash1.png" alt="">
          <div class="card-body">
            <h4 class="card-title">Blank Temlate</h4>
            <p class="card-text">Use over 400+ images to create your own worksheet from scratch.</p>
          </div>
          <div class="card-footer">
            <a href="konva2.html" class="btn btn-primary">Create</a>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-5">
        <div class="card h-100">
          <img class="card-img-top" src="./assets/worksheets_images/dash3.png" alt="">
          <div class="card-body">
            <h4 class="card-title">Edit an existing Template</h4>
            <p class="card-text">Explore editable worksheets created by experts and add your own ideas in browser.</p>
          </div>
          <div class="card-footer">
            <a href="template-dashboard.html" class="btn btn-primary">Use Template</a>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-5">
        <div class="card h-100">
          <img class="card-img-top" src="./assets/worksheets_images/dash2.png" height="300px" alt="">
          <div class="card-body">
            <h4 class="card-title">Download WorkSheets</h4>
            <p class="card-text">Download over 70+ expert currated worksheets directly. Explore Now!! </p>
          </div>
          <div class="card-footer">
            <div onclick="route()"><a link class="btn btn-primary">Explore</a></div>
          </div>
        </div>
      </div>
    </div>
    <!-- /.row -->
    <div class="row">
      <div class="col-md-8 mb-5">
        <!-- <h2>What We Do</h2>
        <hr>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. A deserunt neque tempore recusandae animi soluta quasi? Asperiores rem dolore eaque vel, porro, soluta unde debitis aliquam laboriosam. Repellat explicabo, maiores!</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Omnis optio neque consectetur consequatur magni in nisi, natus beatae quidem quam odit commodi ducimus totam eum, alias, adipisci nesciunt voluptate. Voluptatum.</p>
        <a class="btn btn-primary btn-lg" href="#">Call to Action &raquo;</a> -->
      </div>
      <!-- <div class="col-md-4 mb-5">
        <h2>Contact Us</h2>
        <hr>
        <address>
          <strong>NerdNerdy</strong>
          <br>Gurguoan
          <br>Harayana, India
          <br>
        </address>
        <address>
          <abbr title="Phone">P:</abbr>
          (+91) 8826233770
          <br>
          <abbr title="Email">E:</abbr>
          <a href="mailto:#">vasalchahat@gmail.com</a>
        </address>
      </div> -->
    </div>

  </div>
  <!-- /.container -->


  <!-- Footer -->
  <footer class="py-3 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">Copyright &copy; NerdNerdy 2020. A Product of JumpHats</p>
    </div>
    <!-- /.container -->
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script>
var paid = false;
var email = 'pauljoshua.in@gmail.com';
var curr = '';
var data = {
  UserPoolId : _config.cognito.userPoolId,
      ClientId : _config.cognito.clientId
  };
  var userPool = new AmazonCognitoIdentity.CognitoUserPool(data);
  var cognitoUser = userPool.getCurrentUser();

window.onload = function(){

  if (cognitoUser != null) {
      cognitoUser.getSession(function(err, session) {
          if (err) {
              alert(err);
              return;
          }
          console.log('session validity: ' + session.isValid());
    // get details if the user is paid or not
    // var sessionIdInfo = parseJwt(session.getIdToken().jwtToken);

    // console.log(sessionIdInfo);
    // console.log(sessionIdInfo['cognito:groups']);
    // var group = sessionIdInfo['cognito:groups'];
    // console.log(group);
    //Set the profile info
    cognitoUser.getUserAttributes(function(err, result) {
      if (err) {
        console.log(err);
        return;
      }
      console.log(result);
      curr = result[2].getValue();
      if(result[2].getValue()==1){
        paid = true;
        document.getElementById("email_value").innerHTML = result[3].getValue();
        // disappear buy now
        var ele = document.getElementById("buy-btn");
        ele.classList.add("dissappear");

      }
      else{
      document.getElementById("email_value").innerHTML = result[2].getValue();
    }
    });

      });

  }
  else{
    setTimeout(function(){document.location.href = "login.html"},500);

  }
}

function signOut(){
    if (cognitoUser != null) {
        cognitoUser.signOut();
        window.location.href = "index.html" ;
      }
}
function parseJwt (token) {
    var base64Url = token.split('.')[1];
    var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));

    return JSON.parse(jsonPayload);
};
function route(){
  console.log(email,curr);
  if(paid){
    window.location.href = "readydownloads.html";
  }
  else{
  window.location.href = "readydownloads-demo.html";}
}
function pay(){
  var stripe = Stripe('pk_live_51HQ60SBa0trLGZxvMW7PeJLe4e2TNhDrVh8zPXeGnD9wOVkHQq1CoMup0MQ2em0P7jI1L1p4uSSSv1hm65QQmaBV00noaoK3Tg');
  stripe.redirectToCheckout({
    lineItems: [{
      price: 'price_1HQG0CBa0trLGZxvs1txQ2d8', // Replace with the ID of your price
      quantity: 1,
    }],
    mode: 'payment',
    successUrl: 'https://www.jumphats.com/login.html',
    cancelUrl: 'https://www.jumphats.com/register.html',
  }).then(function (result) {
// If `redirectToCheckout` fails due to a browser or network
// error, display the localized error message to your customer
// using `result.error.message`.
  });
}
  </script>
  <!-- stylr -->
  <style media="screen">
    .dissappear {
      display: none;
    }
  </style>

</body>

</html>
